'use client';\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useTradeStore } from '@/stores/tradeStore';\nimport { ExchangeAPI, ExchangeConnection } from '@/lib/exchange-api';\nimport OrderExecutionPanel from '@/components/trade/OrderExecutionPanel';\nimport TradeHistoryTable from '@/components/trade/TradeHistoryTable';\nimport RealTimeMarketData from '@/components/trade/RealTimeMarketData';\nimport RiskManagementWidget from '@/components/trade/RiskManagementWidget';\nimport PositionMonitor from '@/components/trade/PositionMonitor';\nimport ExchangeConnectionStatus from '@/components/trade/ExchangeConnectionStatus';\nimport { OrderType, OrderSide, TimeInForce, OrderStatus, Trade } from '@/types/trade';\n\nexport default function TradeExecutionPage() {\n  const {\n    selectedExchange,\n    selectedSymbol,\n    orders,\n    trades,\n    positions,\n    connectionStatus,\n    addOrder,\n    updateOrder,\n    addTrade,\n    updatePosition,\n    setConnectionStatus,\n    setMarketData,\n    setSelectedSymbol\n  } = useTradeStore();\n  \n  const [isConnecting, setIsConnecting] = useState(false);\n  const [apiError, setApiError] = useState<string | null>(null);\n  const [marketData, setLocalMarketData] = useState<any>(null);\n  \n  // Initialize exchange connection\n  const connectToExchange = useCallback(async () => {\n    if (!selectedExchange) {\n      setApiError('Please select an exchange first');\n      return;\n    }\n    \n    setIsConnecting(true);\n    setApiError(null);\n    \n    try {\n      await ExchangeAPI.connect(selectedExchange);\n      setConnectionStatus('connected');\n      \n      // Subscribe to market data\n      if (selectedSymbol) {\n        await ExchangeAPI.subscribeToMarketData(selectedSymbol, (data) => {\n          setMarketData(data);\n          setLocalMarketData(data);\n        });\n      }\n      \n    } catch (error: any) {\n      console.error('Connection failed:', error);\n      setApiError(`Failed to connect to ${selectedExchange}: ${error.message}`);\n      setConnectionStatus('disconnected');\n    } finally {\n      setIsConnecting(false);\n    }\n  }, [selectedExchange, selectedSymbol, setConnectionStatus, setMarketData]);\n  \n  // Disconnect from exchange\n  const disconnectFromExchange = useCallback(async () => {\n    try {\n      await ExchangeAPI.disconnect();\n      setConnectionStatus('disconnected');\n      setLocalMarketData(null);\n    } catch (error: any) {\n      console.error('Disconnection failed:', error);\n      setApiError(`Failed to disconnect: ${error.message}`);\n    }\n  }, [setConnectionStatus]);\n  \n  // Handle symbol change\n  const handleSymbolChange = useCallback(async (symbol: string) => {\n    setSelectedSymbol(symbol);\n    \n    if (connectionStatus === 'connected') {\n      try {\n        // Unsubscribe from previous symbol\n        if (selectedSymbol) {\n          await ExchangeAPI.unsubscribeFromMarketData(selectedSymbol);\n        }\n        \n        // Subscribe to new symbol\n        await ExchangeAPI.subscribeToMarketData(symbol, (data) => {\n          setMarketData(data);\n          setLocalMarketData(data);\n        });\n      } catch (error: any) {\n        console.error('Symbol change failed:', error);\n        setApiError(`Failed to change symbol: ${error.message}`);\n      }\n    }\n  }, [connectionStatus, selectedSymbol, setMarketData, setSelectedSymbol]);\n  \n  // Handle order execution\n  const handleOrderSubmit = useCallback(async (orderData: {\n    symbol: string;\n    side: OrderSide;\n    type: OrderType;\n    quantity: number;\n    price?: number;\n    stopPrice?: number;\n    timeInForce?: TimeInForce;\n  }) => {\n    if (connectionStatus !== 'connected') {\n      setApiError('Not connected to exchange');\n      return;\n    }\n    \n    try {\n      // Create pending order\n      const pendingOrder = {\n        id: `order_${Date.now()}`,\n        ...orderData,\n        status: 'pending' as OrderStatus,\n        timestamp: new Date().toISOString(),\n        exchange: selectedExchange,\n        filledQuantity: 0,\n        remainingQuantity: orderData.quantity,\n        avgPrice: 0,\n        fees: 0\n      };\n      \n      addOrder(pendingOrder);\n      \n      // Execute order via exchange API\n      const result = await ExchangeAPI.executeOrder({\n        ...orderData,\n        exchange: selectedExchange\n      });\n      \n      // Update order status\n      updateOrder(pendingOrder.id, {\n        status: result.status,\n        orderId: result.orderId,\n        filledQuantity: result.filledQuantity,\n        remainingQuantity: result.remainingQuantity,\n        avgPrice: result.avgPrice,\n        fees: result.fees,\n        lastUpdate: new Date().toISOString()\n      });\n      \n      // If order was filled, add to trade history\n      if (result.filledQuantity > 0) {\n        const trade: Trade = {\n          id: `trade_${Date.now()}`,\n          orderId: pendingOrder.id,\n          exchangeOrderId: result.orderId,\n          symbol: orderData.symbol,\n          side: orderData.side,\n          quantity: result.filledQuantity,\n          price: result.avgPrice,\n          fees: result.fees,\n          timestamp: new Date().toISOString(),\n          exchange: selectedExchange\n        };\n        \n        addTrade(trade);\n        \n        // Update position\n        updatePosition({\n          symbol: orderData.symbol,\n          side: orderData.side,\n          quantity: result.filledQuantity,\n          avgEntryPrice: result.avgPrice,\n          unrealizedPnl: 0,\n          realizedPnl: 0\n        });\n      }\n      \n    } catch (error: any) {\n      console.error('Order execution failed:', error);\n      setApiError(`Order failed: ${error.message}`);\n      \n      // Update order status to failed\n      if (orderData.symbol) {\n        updateOrder(`order_${Date.now()}`, {\n          status: 'failed' as OrderStatus,\n          error: error.message\n        });\n      }\n    }\n  }, [connectionStatus, selectedExchange, addOrder, updateOrder, addTrade, updatePosition]);\n  \n  // Handle order cancellation\n  const handleCancelOrder = useCallback(async (orderId: string) => {\n    try {\n      const order = orders.find(o => o.id === orderId);\n      if (!order) throw new Error('Order not found');\n      \n      if (order.orderId) {\n        await ExchangeAPI.cancelOrder(order.orderId);\n      }\n      \n      updateOrder(orderId, { \n        status: 'cancelled' as OrderStatus,\n        lastUpdate: new Date().toISOString()\n      });\n    } catch (error: any) {\n      console.error('Cancel order failed:', error);\n      setApiError(`Cancel failed: ${error.message}`);\n    }\n  }, [orders, updateOrder]);\n  \n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (connectionStatus === 'connected') {\n        ExchangeAPI.disconnect().catch(console.error);\n      }\n    };\n  }, [connectionStatus]);\n  \n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white p-4 md:p-6\">\n      <div className=\"container mx-auto\">\n        <header className=\"mb-6\">\n          <h1 className=\"text-2xl md:text-3xl font-bold text-gray-100\">Trade Execution Module</h1>\n          <p className=\"text-gray-400 mt-2\">Execute trades with real-time market data and risk management</p>\n        </header>\n        \n        {/* Connection Status */}\n        <ExchangeConnectionStatus \n          status={connectionStatus}\n          isConnecting={isConnecting}\n          exchange={selectedExchange}\n          symbol={selectedSymbol}\n          error={apiError}\n          onConnect={connectToExchange}\n          onDisconnect={disconnectFromExchange}\n          onSymbolChange={handleSymbolChange}\n        />\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6\">\n          {/* Left Column - Trading Interface */}\n          <div className=\"lg:col-span-2 space-y-4 md:space-y-6\">\n            {/* Real-time Market Data */}\n            <div className=\"bg-gray-800 rounded-xl shadow-lg overflow-hidden\">\n              <RealTimeMarketData \n                symbol={selectedSymbol}\n                marketData={marketData}\n                onSymbolChange={handleSymbolChange}\n              />\n            </div>\n            \n            {/* Order Execution Panel */}\n            <div className=\"bg-gray-800 rounded-xl shadow-lg\">\n              <OrderExecutionPanel \n                onSubmit={handleOrderSubmit}\n                isConnected={connectionStatus === 'connected'}\n                selectedSymbol={selectedSymbol}\n                marketData={marketData}\n                onSymbolChange={handleSymbolChange}\n              />\n            </div>\n            \n            {/* Position Monitor */}\n            <div className=\"bg-gray-800 rounded-xl shadow-lg\">\n              <PositionMonitor \n                positions={positions}\n                marketData={marketData}\n              />\n            </div>\n          </div>\n          \n          {/* Right Column - Risk & History */}\n          <div className=\"space-y-4 md:space-y-6\">\n            {/* Risk Management Widget */}\n            <div className=\"bg-gray-800 rounded-xl shadow-lg\">\n              <RiskManagementWidget \n                positions={positions}\n                trades={trades}\n                selectedSymbol={selectedSymbol}\n                marketData={marketData}\n              />\n            </div>\n            \n            {/* Trade History */}\n            <div className=\"bg-gray-800 rounded-xl shadow-lg\">\n              <TradeHistoryTable \n                trades={trades}\n                selectedSymbol={selectedSymbol}\n              />\n            </div>\n            \n            {/* Order Status Summary */}\n            <div className=\"bg-gray-800 p-4 md:p-6 rounded-xl shadow-lg\">\n              <h3 className=\"text-lg font-semibold mb-4 text-gray-200\">Order Status</h3>\n              <div className=\"space-y-3\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-gray-400\">Pending Orders</span>\n                  <span className=\"text-yellow-500 font-medium\">\n                    {orders.filter(o => o.status === 'pending').length}\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-gray-400\">Filled Today</span>\n                  <span className=\"text-green-500 font-medium\">\n                    {trades.filter(t => \n                      new Date(t.timestamp).toDateString() === new Date().toDateString()\n                    ).length}\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-gray-400\">Active Positions</span>\n                  <span className=\"text-blue-500 font-medium\">\n                    {positions.length}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"     },     {       "path": "components/trade/OrderExecutionPanel.tsx",       "content": "'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { OrderType, OrderSide, TimeInForce } from '@/types/trade';\n\ntype OrderExecutionPanelProps = {\n  onSubmit: (orderData: {\n    symbol: string;\n    side: OrderSide;\n    type: OrderType;\n    quantity: number;\n    price?: number;\n    stopPrice?: number;\n    timeInForce?: TimeInForce;\n  }) => void;\n  isConnected: boolean;\n  selectedSymbol: string | null;\n  marketData: any;\n  onSymbolChange: (symbol: string) => void;\n};\n\ntype OrderFormData = {\n  symbol: string;\n  side: OrderSide;\n  type: OrderType;\n  quantity: string;\n  price: string;\n  stopPrice: string;\n  timeInForce: TimeInForce;\n};\n\nexport default function OrderExecutionPanel({\n  onSubmit,\n  isConnected,\n  selectedSymbol,\n  marketData,\n  onSymbolChange\n}: OrderExecutionPanelProps) {\n  const [formData, setFormData] = useState<OrderFormData>({\n    symbol: selectedSymbol || '',\n    side: 'buy',\n    type: 'limit',\n    quantity: '',\n    price: '',\n    stopPrice: '',\n    timeInForce: 'GTC'\n  });\n  \n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  // Update form when selected symbol changes\n  useEffect(() => {\n    if (selectedSymbol) {\n      setFormData(prev => ({\n        ...prev,\n        symbol: selectedSymbol\n      }));\n      \n      // Set market price if available\n      if (marketData?.lastPrice) {\n        setFormData(prev => ({\n          ...prev,\n          price: marketData.lastPrice.toString()\n        }));\n      }\n    }\n  }, [selectedSymbol, marketData]);\n  \n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n    \n    if (name === 'symbol') {\n      onSymbolChange(value);\n    }\n  };\n  \n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!isConnected) {\n      alert('Please connect to exchange first');\n      return;\n    }\n    \n    if (!formData.symbol) {\n      alert('Please select a symbol');\n      return;\n    }\n    \n    setIsSubmitting(true);\n    \n    try {\n      const orderData = {\n        symbol: formData.symbol,\n        side: formData.side,\n        type: formData.type,\n        quantity: parseFloat(formData.quantity),\n        price: formData.price ? parseFloat(formData.price) : undefined,\n        stopPrice: formData.stopPrice ? parseFloat(formData.stopPrice) : undefined,\n        timeInForce: formData.timeInForce\n      };\n      \n      // Validate order data\n      if (orderData.quantity <= 0) {\n        throw new Error('Quantity must be greater than 0');\n      }\n      \n      if (orderData.type === 'limit' && !orderData.price) {\n        throw new Error('Price is required for limit orders');\n      }\n      \n      if (orderData.type === 'stop_limit' && (!orderData.price || !orderData.stopPrice)) {\n        throw new Error('Price and stop price are required for stop-limit orders');\n      }\n      \n      onSubmit(orderData);\n      \n      // Reset form\n      setFormData(prev => ({\n        ...prev,\n        quantity: '',\n        price: marketData?.lastPrice ? marketData.lastPrice.toString() : '',\n        stopPrice: ''\n      }));\n      \n    } catch (error: any) {\n      alert(error.message);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n  \n  const handleQuickOrder = (percentage: number) => {\n    if (!marketData?.lastPrice) return;\n    \n    const availableBalance = 10000; // Mock balance\n    const price = marketData.lastPrice;\n    const maxQuantity = availableBalance / price;\n    const quantity = maxQuantity * (percentage / 100);\n    \n    setFormData(prev => ({\n      ...prev,\n      quantity: quantity.toFixed(4),\n      price: price.toString()\n    }));\n  };\n  \n  return (\n    <div className=\"p-4 md:p-6\">\n      <h2 className=\"text-xl font-semibold mb-4 text-gray-100\">Order Execution</h2>\n      \n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Symbol Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n            Symbol\n          </label>\n          <div className=\"flex space-x-2\">\n            <input\n              type=\"text\"\n              name=\"symbol\"\n              value={formData.symbol}\n              onChange={handleInputChange}\n              className=\"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              placeholder=\"e.g., BTC/USDT, SBER\"\n              required\n            />\n            <div className=\"flex space-x-2\">\n              {['BTC/USDT', 'ETH/USDT', 'SBER', 'GAZP'].map(symbol => (\n                <button\n                  key={symbol}\n                  type=\"button\"\n                  onClick={() => {\n                    setFormData(prev => ({ ...prev, symbol }));\n                    onSymbolChange(symbol);\n                  }}\n                  className={`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${\n                    formData.symbol === symbol\n                      ? 'bg-blue-600 text-white'\n                      : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n                  }`}\n                >\n                  {symbol}\n                </button>\n              ))}\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {/* Order Side */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n              Side\n            </label>\n            <div className=\"flex space-x-2\">\n              <button\n                type=\"button\"\n                onClick={() => setFormData(prev => ({ ...prev, side: 'buy' }))}\n                className={`flex-1 py-3 rounded-lg font-medium transition-colors ${\n                  formData.side === 'buy'\n                    ? 'bg-green-600 text-white'\n                    : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n                }`}\n              >\n                Buy\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setFormData(prev => ({ ...prev, side: 'sell' }))}\n                className={`flex-1 py-3 rounded-lg font-medium transition-colors ${\n                  formData.side === 'sell'\n                    ? 'bg-red-600 text-white'\n                    : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n                }`}\n              >\n                Sell\n              </button>\n            </div>\n          </div>\n          \n          {/* Order Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n              Order Type\n            </label>\n            <select\n              name=\"type\"\n              value={formData.type}\n              onChange={handleInputChange}\n              className=\"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"market\">Market</option>\n              <option value=\"limit\">Limit</option>\n              <option value=\"stop\">Stop</option>\n              <option value=\"stop_limit\">Stop Limit</option>\n            </select>\n          </div>\n        </div>\n        \n        {/* Quantity */}\n        <div>\n          <div className=\"flex justify-between items-center mb-2\">\n            <label className=\"block text-sm font-medium text-gray-400\">\n              Quantity\n            </label>\n            <div className=\"flex space-x-2\">\n              {[25, 50, 75, 100].map(percent => (\n                <button\n                  key={percent}\n                  type=\"button\"\n                  onClick={() => handleQuickOrder(percent)}\n                  className=\"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded hover:bg-gray-600\"\n                >\n                  {percent}%\n                </button>\n              ))}\n            </div>\n          </div>\n          <input\n            type=\"number\"\n            name=\"quantity\"\n            value={formData.quantity}\n            onChange={handleInputChange}\n            step=\"any\"\n            min=\"0\"\n            className=\"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            placeholder=\"0.00\"\n            required\n          />\n        </div>\n        \n        {/* Price Inputs */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {formData.type !== 'market' && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                {formData.type === 'stop' ? 'Stop Price' : 'Price'}\n              </label>\n              <input\n                type=\"number\"\n                name=\"price\"\n                value={formData.price}\n                onChange={handleInputChange}\n                step=\"any\"\n                min=\"0\"\n                className=\"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                placeholder=\"0.00\"\n                required={formData.type !== 'market'}\n              />\n            </div>\n          )}\n          \n          {(formData.type === 'stop' || formData.type === 'stop_limit') && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n                Stop Price\n              </label>\n              <input\n                type=\"number\"\n                name=\"stopPrice\"\n                value={formData.stopPrice}\n                onChange={handleInputChange}\n                step=\"any\"\n                min=\"0\"\n                className=\"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                placeholder=\"0.00\"\n                required={formData.type === 'stop_limit'}\n              />\n            </div>\n          )}\n        </div>\n        \n        {/* Time in Force */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-400 mb-2\">\n            Time in Force\n          </label>\n          <select\n            name=\"timeInForce\"\n            value={formData.timeInForce}\n            onChange={handleInputChange}\n            className=\"w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n          >\n            <option value=\"GTC\">Good Till Cancel (GTC)</option>\n            <option value=\"IOC\">Immediate or Cancel (IOC)</option>\n            <option value=\"FOK\">Fill or Kill (FOK)</option>\n            <option value=\"DAY\">Day</option>\n          </select>\n        </div>\n        \n        {/* Market Data Summary */}\n        {marketData && (\n          <div className=\"bg-gray-700 rounded-lg p-4\">\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div>\n                <span className=\"text-gray-400\">Last Price:</span>\n                <span className={`ml-2 font-medium ${\n                  marketData.change >= 0 ? 'text-green-400' : 'text-red-400'\n                }`}>\n                  {marketData.lastPrice?.toFixed(2) || 'N/A'}\n                </span>\n              </div>\n              <div>\n                <span className=\"text-gray-400\">24h Change:</span>\n                <span className={`ml-2 font-medium ${\n                  marketData.change >= 0 ? 'text-green-400' : 'text-red-400'\n                }`}>\n                  {marketData.change >= 0 ? '+' : ''}{marketData.change?.toFixed(2)}%\n                </span>\n              </div>\n              <div>\n                <span className=\"text-gray-400\">Bid:</span>\n                <span className=\"ml-2 font-medium text-green-400\">\n                  {marketData.bid?.toFixed(2) || 'N/A'}\n                </span>\n              </div>\n              <div>\n                <span className=\"text-gray-400\">Ask:</span>\n                <span className=\"ml-2 font-medium text-red-400\">\n                  {marketData.ask?.toFixed(2) || 'N/A'}\n                </span>\n              </div>\n            </div>\n          </div>\n        )}\n        \n        {/* Submit Button */}\n        <button\n          type=\"submit\"\n          disabled={!isConnected || isSubmitting}\n          className={`w-full py-3 rounded-lg font-medium transition-colors ${\n            isConnected && !isSubmitting\n              ? formData.side === 'buy'\n                ? 'bg-green-600 hover:bg-green-700 text-white'\n                : 'bg-red-600 hover:bg-red-700 text-white'\n              : 'bg-gray-700 text-gray-400 cursor-not-allowed'\n          }`}\n        >\n          {isSubmitting ? 'Submitting...' : `Place ${formData.side.toUpperCase()} Order`}\n        </button>\n      </form>\n    </div>\n  );\n}\n"     },     {       "path": "components/trade/TradeHistoryTable.tsx",       "content": "'use client';\n\nimport React, { useState, useMemo } from 'react';\nimport { Trade } from '@/types/trade';\n\ntype TradeHistoryTableProps = {\n  trades: Trade[];\n  selectedSymbol: string | null;\n};\n\nexport default function TradeHistoryTable({ trades, selectedSymbol }: TradeHistoryTableProps) {\n  const [filter, setFilter] = useState<'all' | 'buy' | 'sell'>('all');\n  \n  const filteredTrades = useMemo(() => {\n    let filtered = trades;\n    \n    if (selectedSymbol) {\n      filtered = filtered.filter(trade => trade.symbol === selectedSymbol);\n    }\n    \n    if (filter !== 'all') {\n      filtered = filtered.filter(trade => trade.side === filter);\n    }\n    \n    return filtered.sort((a, b) => \n      new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n    );\n  }, [trades, selectedSymbol, filter]);\n  \n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n  \n  const calculateTotal = () => {\n    const totals = filteredTrades.reduce(\n      (acc, trade) => {\n        const value = trade.quantity * trade.price;\n        if (trade.side === 'buy') {\n          acc.buyVolume += trade.quantity;\n          acc.buyValue += value;\n        } else {\n          acc.sellVolume += trade.quantity;\n          acc.sellValue += value;\n        }\n        acc.totalFees += trade.fees;\n        return acc;\n      },\n      { buyVolume: 0, sellVolume: 0, buyValue: 0, sellValue: 0, totalFees: 0 }\n    );\n    \n    return {\n      ...totals,\n      netVolume: totals.buyVolume - totals.sellVolume,\n      netValue: totals.buyValue - totals.sellValue\n    };\n  };\n  \n  const totals = calculateTotal();\n  \n  return (\n    <div className=\"p-4 md:p-6\">\n      <div className=\"flex justify-between items-center mb-4\">\n        <h3 className=\"text-lg font-semibold text-gray-100\">Trade History</h3>\n        <div className=\"flex space-x-2\">\n          <button\n            onClick={() => setFilter('all')}\n            className={`px-3 py-1 text-sm rounded-lg transition-colors ${\n              filter === 'all'\n                ? 'bg-blue-600 text-white'\n                : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n            }`}\n          >\n            All\n          </button>\n          <button\n            onClick={() => setFilter('buy')}\n            className={`px-3 py-1 text-sm rounded-lg transition-colors ${\n              filter === 'buy'\n                ? 'bg-green-600 text-white'\n                : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n            }`}\n          >\n            Buy\n          </button>\n          <button\n            onClick={() => setFilter('sell')}\n            className={`px-3 py-1 text-sm rounded-lg transition-colors ${\n              filter === 'sell'\n                ? 'bg-red-600 text-white'\n                : 'bg-gray-700 text-gray-300 hover:bg-gray-600'\n            }`}\n          >\n            Sell\n          </button>\n        </div>\n      </div>\n      \n      {/* Summary Stats */}\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4\">\n        <div className=\"bg-gray-700 rounded-lg p-3\">\n          <div className=\"text-xs text-gray-400\">Total Trades</div>\n          <div className=\"text-lg font-semibold text-white\">{filteredTrades.length}</div>\n        </div>\n        <div className=\"bg-gray-700 rounded-lg p-3\">\n          <div className=\"text-xs text-gray-400\">Net Volume</div>\n          <div className={`text-lg font-semibold ${\n            totals.netVolume >= 0 ? 'text-green-400' : 'text-red-400'\n          }`}>\n            {totals.netVolume.toFixed(4)}\n          </div>\n        </div>\n        <div className=\"bg-gray-700 rounded-lg p-3\">\n          <div className=\"text-xs text-gray-400\">Total Fees</div>\n          <div className=\"text-lg font-semibold text-yellow-400\">\n            ${totals.totalFees.toFixed(2)}\n          </div>\n        </div>\n        <div className=\"bg-gray-700 rounded-lg p-3\">\n          <div className=\"text-xs text-gray-400\">Net Value</div>\n          <div className={`text-lg font-semibold ${\n            totals.netValue >= 0 ? 'text-green-400' : 'text-red-400'\n          }`}>\n            ${Math.abs(totals.netValue).toFixed(2)}\n          </div>\n        </div>\n      </div>\n      \n      {/* Trades Table */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead>\n            <tr className=\"border-b border-gray-700\">\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">Time</th>\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">Symbol</th>\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">Side</th>\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">Quantity</th>\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking-wider\">Price</th>\n              <th className=\"text-left py-3 px-2 text-xs font-medium text-gray-400 uppercase tracking